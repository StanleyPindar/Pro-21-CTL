import{c as E,r as n,j as e,e as A,w as I,s as i}from"./index-BgERFsfp.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=E("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function D(){const[r,N]=n.useState("admin@admin.com"),[l,v]=n.useState("admin123"),[s,o]=n.useState("idle"),[u,t]=n.useState(""),[g,h]=n.useState(""),y=async a=>{var p,b;a.preventDefault(),o("loading"),t("Creating admin user...");try{const{data:c,error:x}=await i.auth.signUp({email:r,password:l});if(x){if(x.message.includes("already registered")){t("User exists. Trying to sign in and add to admin_users...");const{data:S,error:j}=await i.auth.signInWithPassword({email:r,password:l});if(j)throw new Error(`Sign in failed: ${j.message}`);const m=(p=S.user)==null?void 0:p.id;if(!m)throw new Error("No user ID returned");h(m);const{error:w}=await i.from("admin_users").upsert([{id:m,email:r,role:"admin"}]);if(w)throw new Error(`Failed to add to admin_users: ${w.message}`);await i.auth.signOut(),o("success"),t(`Admin user setup complete! User ID: ${m}`);return}throw x}const d=(b=c.user)==null?void 0:b.id;if(!d)throw new Error("No user ID returned from signup");h(d),t(`User created with ID: ${d}. Adding to admin_users table...`);const{error:f}=await i.from("admin_users").insert([{id:d,email:r,role:"admin"}]);if(f)throw new Error(`Failed to add to admin_users: ${f.message}`);o("success"),t(`Admin user created successfully! User ID: ${d}`)}catch(c){o("error"),t(c.message||"An error occurred"),console.error("Setup error:",c)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 flex items-center justify-center px-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:e.jsx(A,{className:"w-8 h-8 text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-900 mb-2",children:"Admin Setup"}),e.jsx("p",{className:"text-slate-600",children:"Create your first admin user"})]}),s==="success"?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(C,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-1",children:"Setup Complete!"}),e.jsx("p",{className:"text-sm text-green-700",children:u}),g&&e.jsxs("p",{className:"text-xs text-green-600 mt-2 font-mono bg-green-100 p-2 rounded",children:["User ID: ",g]})]})]})}),e.jsxs("div",{className:"space-y-2 text-sm text-slate-700 bg-slate-50 p-4 rounded-lg",children:[e.jsx("p",{className:"font-semibold",children:"Login Credentials:"}),e.jsxs("p",{children:["Email: ",e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:r})]}),e.jsxs("p",{children:["Password: ",e.jsx("code",{className:"bg-white px-2 py-1 rounded",children:l})]})]}),e.jsx("a",{href:"/admin/login",className:"block w-full text-center bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:"Go to Admin Login"})]}):e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[s==="error"&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(I,{className:"w-5 h-5 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Setup Failed"}),e.jsx("p",{className:"text-sm text-red-700",children:u})]})]})}),s==="loading"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-blue-700",children:u})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-slate-700 mb-2",children:"Admin Email"}),e.jsx("input",{id:"email",type:"email",value:r,onChange:a=>N(a.target.value),required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:s==="loading"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 mb-2",children:"Admin Password"}),e.jsx("input",{id:"password",type:"text",value:l,onChange:a=>v(a.target.value),required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:s==="loading"}),e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Minimum 6 characters"})]}),e.jsx("button",{type:"submit",disabled:s==="loading",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed",children:s==="loading"?"Creating Admin User...":"Create Admin User"}),e.jsx("p",{className:"text-xs text-slate-500 text-center",children:"This page creates an admin user and adds them to the admin_users table"})]})]})})})}export{D as default};
