import{c,r as x,j as e,w as D,u as R,i as F,s as S,z as O,n as U,m as V,X as W}from"./index-ktae_aew.js";import{L as G,e as K}from"./enhancedMarkdownParser-CAGutkyf.js";import{a as X}from"./sanitizeHtml-CWFqxZzB.js";import{E}from"./eye-L33N8S8g.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=c("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=c("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=c("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=c("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=c("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=c("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=c("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=c("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=c("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=c("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=c("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function re({value:n,onChange:w,placeholder:m}){const[d,b]=x.useState("split"),[p,v]=x.useState(!0),o=(l,g="",a="")=>{const r=document.getElementById("markdown-textarea");if(!r)return;const f=r.selectionStart,N=r.selectionEnd,y=n.substring(f,N)||a,k=n.substring(0,f)+l+y+g+n.substring(N);w(k),setTimeout(()=>{r.focus();const C=f+l.length+y.length;r.setSelectionRange(C,C)},0)},u=[{icon:Y,label:"Bold",action:()=>o("**","**","bold text")},{icon:ee,label:"Italic",action:()=>o("*","*","italic text")},{icon:ae,label:"Heading",action:()=>o("## ","","Heading")},{icon:G,label:"List",action:()=>o("- ","","List item")},{icon:te,label:"Link",action:()=>o("[","](https://example.com)","link text")},{icon:Q,label:"Image",action:()=>o("![","](https://example.com/image.jpg)","alt text")},{icon:se,label:"Table",action:()=>o(`| Header 1 | Header 2 |
| --- | --- |
| Cell 1 | Cell 2 |
`,"","")},{icon:q,label:"Code Block",action:()=>o("```\n","\n```","code here")},{icon:D,label:"Callout",action:()=>o("> [!NOTE] ","","Your note here")}];return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200",children:[e.jsxs("div",{className:"border-b border-slate-200 p-3 flex items-center justify-between bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>b("edit"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${d==="edit"?"bg-green-600 text-white":"text-slate-600 hover:bg-slate-200"}`,children:[e.jsx(q,{className:"w-4 h-4 inline mr-1"}),"Edit"]}),e.jsxs("button",{onClick:()=>b("split"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${d==="split"?"bg-green-600 text-white":"text-slate-600 hover:bg-slate-200"}`,children:[e.jsx(Z,{className:"w-4 h-4 inline mr-1"}),"Split"]}),e.jsxs("button",{onClick:()=>b("preview"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${d==="preview"?"bg-green-600 text-white":"text-slate-600 hover:bg-slate-200"}`,children:[e.jsx(E,{className:"w-4 h-4 inline mr-1"}),"Preview"]})]}),e.jsx("button",{onClick:()=>v(!p),className:"p-1.5 text-slate-600 hover:bg-slate-200 rounded-md transition-colors",title:p?"Hide toolbar":"Show toolbar",children:p?e.jsx(J,{className:"w-4 h-4"}):e.jsx(E,{className:"w-4 h-4"})})]}),p&&e.jsx("div",{className:"border-b border-slate-200 p-2 flex flex-wrap gap-1 bg-slate-50",children:u.map((l,g)=>e.jsx("button",{onClick:l.action,className:"p-2 text-slate-600 hover:bg-slate-200 rounded-md transition-colors",title:l.label,children:e.jsx(l.icon,{className:"w-4 h-4"})},g))}),e.jsxs("div",{className:`grid ${d==="split"?"grid-cols-2":"grid-cols-1"} divide-x divide-slate-200`,children:[(d==="edit"||d==="split")&&e.jsx("div",{className:"relative",children:e.jsx("textarea",{id:"markdown-textarea",value:n,onChange:l=>w(l.target.value),placeholder:m||"Write your article content in markdown...",className:"w-full h-[600px] p-4 font-mono text-sm text-slate-900 placeholder-slate-400 focus:outline-none resize-none",spellCheck:"true"})}),(d==="preview"||d==="split")&&e.jsx("div",{className:"bg-white overflow-auto h-[600px]",children:e.jsx("div",{className:"p-6 prose prose-slate max-w-none",children:n?e.jsx("div",{dangerouslySetInnerHTML:{__html:X(K(n))}}):e.jsx("p",{className:"text-slate-400 italic",children:"Preview will appear here..."})})})]}),e.jsxs("div",{className:"border-t border-slate-200 px-4 py-2 bg-slate-50 flex items-center justify-between text-xs text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:[n.length," characters"]}),e.jsxs("span",{children:[n.split(/\s+/).filter(l=>l).length," words"]}),e.jsxs("span",{children:[Math.ceil(n.split(/\s+/).filter(l=>l).length/200)," min read"]})]}),e.jsx("div",{className:"text-slate-400",children:"Supports Markdown, tables, code blocks, callouts & more"})]})]})}function de(){const{id:n}=R(),w=F(),m=!!n,[d,b]=x.useState(m),[p,v]=x.useState(!1),[o,u]=x.useState(""),[l,g]=x.useState(""),[a,r]=x.useState({title:"",slug:"",content:"",excerpt:"",author:"",category:"",tags:[],featured_image:"",published:!1,published_at:null});x.useEffect(()=>{m&&n&&f(n)},[n,m]);const f=async t=>{try{const{data:s,error:i}=await S.from("articles").select("*").eq("id",t).maybeSingle();if(i)throw i;if(!s){u("Article not found");return}r({title:s.title||"",slug:s.slug||"",content:s.content||"",excerpt:s.excerpt||"",author:s.author||"",category:s.category||"",tags:s.tags||[],featured_image:s.featured_image||"",published:s.published||!1,published_at:s.published_at||null})}catch(s){console.error("Error loading article:",s),u("Failed to load article")}finally{b(!1)}},N=t=>t.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,""),y=t=>{r(s=>({...s,title:t,slug:s.slug||N(t)}))},k=()=>{l.trim()&&!a.tags.includes(l.trim())&&(r(t=>({...t,tags:[...t.tags,l.trim()]})),g(""))},C=t=>{r(s=>({...s,tags:s.tags.filter(i=>i!==t)}))},z=t=>{var j;const s=(j=t.target.files)==null?void 0:j[0];if(!s)return;const i=new FileReader;i.onload=h=>{var H,P;const A=(H=h.target)==null?void 0:H.result,L=A.split(`
`);let M=a.title,_=A;const I=(P=L[0])==null?void 0:P.match(/^#\s+(.+)$/);I&&(M=I[1],_=L.slice(1).join(`
`).trim()),M&&!a.title&&y(M),r(B=>({...B,content:_}))},i.readAsText(s)},T=async(t,s=!1)=>{t.preventDefault(),u(""),v(!0);try{let i=null;s?a.published&&a.published_at?i=a.published_at:i=new Date().toISOString():i=null;const j={...a,published:s,published_at:i};if(m&&n){const{error:h}=await S.from("articles").update(j).eq("id",n);if(h)throw h}else{const{error:h}=await S.from("articles").insert([j]);if(h)throw h}w("/admin")}catch(i){console.error("Error saving article:",i),u(i.message||"Failed to save article")}finally{v(!1)}};return d?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(O,{})}):e.jsxs("div",{className:"min-h-screen bg-slate-50",children:[e.jsx("header",{className:"bg-white shadow-sm border-b border-slate-200",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(U,{to:"/admin",className:"p-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg transition-colors",children:e.jsx(V,{className:"w-5 h-5"})}),e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:m?"Edit Article":"New Article"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[a.published&&e.jsxs("a",{href:`/articles/${a.slug}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:[e.jsx(E,{className:"w-4 h-4"}),"Preview"]}),e.jsxs("button",{onClick:t=>T(t,!1),disabled:p,className:"flex items-center gap-2 px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-800 font-semibold rounded-lg transition-colors disabled:opacity-50",children:[e.jsx($,{className:"w-4 h-4"}),"Save Draft"]}),e.jsxs("button",{onClick:t=>T(t,!0),disabled:p,className:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-lg transition-colors disabled:opacity-50",children:[e.jsx($,{className:"w-4 h-4"}),a.published?"Update":"Publish"]})]})]})})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o&&e.jsx("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:o}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Title"}),e.jsx("input",{type:"text",value:a.title,onChange:t=>y(t.target.value),required:!0,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-lg font-semibold",placeholder:"Enter article title"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Slug"}),e.jsx("input",{type:"text",value:a.slug,onChange:t=>r(s=>({...s,slug:t.target.value})),required:!0,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent font-mono text-sm",placeholder:"article-slug"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Excerpt"}),e.jsx("textarea",{value:a.excerpt,onChange:t=>r(s=>({...s,excerpt:t.target.value})),rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Brief description for previews"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Content"}),e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg cursor-pointer transition-colors",children:[e.jsx(le,{className:"w-4 h-4"}),"Import Markdown",e.jsx("input",{type:"file",accept:".md,.markdown",onChange:z,className:"hidden"})]})]}),e.jsx(re,{value:a.content,onChange:t=>r(s=>({...s,content:t})),placeholder:"Write your article content in markdown..."})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Metadata"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Author"}),e.jsx("input",{type:"text",value:a.author,onChange:t=>r(s=>({...s,author:t.target.value})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Author name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Category"}),e.jsx("input",{type:"text",value:a.category,onChange:t=>r(s=>({...s,category:t.target.value})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"e.g., Guide, Review, News"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Tags"}),e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",value:l,onChange:t=>g(t.target.value),onKeyPress:t=>t.key==="Enter"&&(t.preventDefault(),k()),className:"flex-1 px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"Add tag"}),e.jsx("button",{type:"button",onClick:k,className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg transition-colors",children:"Add"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(t=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm",children:[t,e.jsx("button",{type:"button",onClick:()=>C(t),className:"hover:text-green-900",children:e.jsx(W,{className:"w-3 h-3"})})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Featured Image URL"}),e.jsx("input",{type:"url",value:a.featured_image,onChange:t=>r(s=>({...s,featured_image:t.target.value})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",placeholder:"https://example.com/image.jpg"}),a.featured_image&&e.jsx("img",{src:a.featured_image,alt:"Preview",className:"mt-2 w-full h-32 object-cover rounded-lg",onError:t=>{t.currentTarget.style.display="none"}})]})]})]})})]})]})]})}export{de as default};
